defmodule Lumber.Wwsac.Prefixes do
  @prefixes MapSet.new([
              "1A",
              "9M0",
              "BM9S",
              "BN9S",
              "BO9S",
              "BP9S",
              "BQ9S",
              "BU9S",
              "BV9S",
              "BW9S",
              "BX9S",
              "3A",
              "3B6",
              "3B7",
              "3B8",
              "3B9",
              "3C",
              "3C0",
              "3D2",
              "3DA",
              "3V",
              "TS",
              "3W",
              "XV",
              "3X",
              "4J",
              "4K",
              "4L",
              "4O",
              "4P",
              "4Q",
              "4R",
              "4S",
              "4W",
              "4X",
              "4Z",
              "5A",
              "5B",
              "C4",
              "H2",
              "P3",
              "5H",
              "5I",
              "5N",
              "5O",
              "5R",
              "5S",
              "6X",
              "5T",
              "5U",
              "5V",
              "5W",
              "5X",
              "5Y",
              "5Z",
              "6V",
              "6W",
              "6Y",
              "7O",
              "7P",
              "7Q",
              "7R",
              "7T",
              "7U",
              "7V",
              "7W",
              "7X",
              "7Y",
              "8P",
              "8Q",
              "8R",
              "9A",
              "9G",
              "9H",
              "9I",
              "9J",
              "9K",
              "NLD",
              "9L",
              "9M",
              "9W",
              "9M6",
              "9M8",
              "9W6",
              "9W8",
              "9N",
              "9O",
              "9P",
              "9Q",
              "9R",
              "9S",
              "9T",
              "9U",
              "9V",
              "S6",
              "9X",
              "9Y",
              "9Z",
              "8O",
              "A2",
              "A3",
              "A4",
              "A5",
              "A6",
              "A7",
              "A9",
              "6P",
              "6Q",
              "6R",
              "6S",
              "AP",
              "AQ",
              "AR",
              "AS",
              "BM",
              "BN",
              "BO",
              "BP",
              "BQ",
              "BU",
              "BV",
              "BW",
              "BX",
              "BM9P",
              "BN9P",
              "BO9P",
              "BP9P",
              "BQ9P",
              "BU9P",
              "BV9P",
              "BW9P",
              "BX9P",
              "3H",
              "3I",
              "3J",
              "3K",
              "3L",
              "3M",
              "3N",
              "3O",
              "3P",
              "3Q",
              "3R",
              "3S",
              "3T",
              "3U",
              "B2",
              "B3",
              "B4",
              "B5",
              "B6",
              "B7",
              "B8",
              "BA",
              "BD",
              "BG",
              "BH",
              "BI",
              "BJ",
              "BL",
              "BT",
              "BY",
              "BZ",
              "XS",
              "B1",
              "C2",
              "C3",
              "C5",
              "C6",
              "C8",
              "C9",
              "3G",
              "CA",
              "CB",
              "CC",
              "CD",
              "CE",
              "XQ",
              "XR",
              "3G0X",
              "CA0X",
              "CB0X",
              "CC0X",
              "CD0X",
              "CE0X",
              "XQ0X",
              "XR0X",
              "3G0",
              "CA0",
              "CB0",
              "CC0",
              "CD0",
              "CE0",
              "XQ0",
              "XR0",
              "3G0Z",
              "CA0Z",
              "CB0Z",
              "CC0Z",
              "CD0Z",
              "CE0I",
              "CE0Z",
              "XQ0Z",
              "XR0Z",
              "CL",
              "CM",
              "CO",
              "T4",
              "5C",
              "5D",
              "5E",
              "5F",
              "5G",
              "CN",
              "CP",
              "CQ",
              "CR",
              "CS",
              "CT",
              "CQ2",
              "CQ3",
              "CQ9",
              "CR3",
              "CR9",
              "CS3",
              "CS9",
              "CT3",
              "CT9",
              "CQ1",
              "CQ8",
              "CR1",
              "CR2",
              "CR8",
              "CS4",
              "CS8",
              "CT8",
              "CU",
              "CV",
              "CW",
              "CX",
              "CY0",
              "CY9",
              "D2",
              "D3",
              "D4",
              "D6",
              "DA",
              "DB",
              "DC",
              "DD",
              "DE",
              "DF",
              "DG",
              "DH",
              "DI",
              "DJ",
              "DK",
              "DL",
              "DM",
              "DN",
              "DO",
              "DP",
              "DQ",
              "DR",
              "Y2",
              "Y3",
              "Y4",
              "Y5",
              "Y6",
              "Y7",
              "Y8",
              "Y9",
              "4D",
              "4E",
              "4F",
              "4G",
              "4H",
              "4I",
              "DU",
              "DV",
              "DW",
              "DX",
              "DY",
              "DZ",
              "E3",
              "E4",
              "E5",
              "E6",
              "E7",
              "AM",
              "AN",
              "AO",
              "EA",
              "EB",
              "EC",
              "ED",
              "EE",
              "EF",
              "EG",
              "EH",
              "AM6",
              "AN6",
              "AO6",
              "EA6",
              "EB6",
              "EC6",
              "ED6",
              "EE6",
              "EF6",
              "EG6",
              "EH6",
              "AM8",
              "AN8",
              "AO8",
              "EA8",
              "EB8",
              "EC8",
              "ED8",
              "EE8",
              "EF8",
              "EG8",
              "EH8",
              "AM9",
              "AN9",
              "AO9",
              "EA9",
              "EB9",
              "EC9",
              "ED9",
              "EE9",
              "EF9",
              "EG9",
              "EH9",
              "EI",
              "EJ",
              "EK",
              "5L",
              "5M",
              "6Z",
              "A8",
              "D5",
              "EL",
              "9B",
              "9C",
              "9D",
              "EP",
              "EQ",
              "ER",
              "ES",
              "9E",
              "9F",
              "ET",
              "EU",
              "EV",
              "EW",
              "EX",
              "EY",
              "EZ",
              "F",
              "HW",
              "HX",
              "HY",
              "TH",
              "TM",
              "TP",
              "TQ",
              "TV",
              "FG",
              "FH",
              "FJ",
              "FK",
              "FM",
              "FO",
              "FP",
              "FR",
              "FS",
              "FT0G",
              "FT1G",
              "FT2G",
              "FT3G",
              "FT4G",
              "FT5G",
              "FT6G",
              "FT7G",
              "FT8G",
              "FT9G",
              "FT0E",
              "FT0J",
              "FT1E",
              "FT1J",
              "FT2E",
              "FT2J",
              "FT3E",
              "FT3J",
              "FT4E",
              "FT4J",
              "FT6E",
              "FT6J",
              "FT7E",
              "FT7J",
              "FT8E",
              "FT8J",
              "FT9E",
              "FT9J",
              "FT0T",
              "FT1T",
              "FT2T",
              "FT3T",
              "FT4T",
              "FT5T",
              "FT6T",
              "FT7T",
              "FT8T",
              "FT9T",
              "FT0W",
              "FT4W",
              "FT5W",
              "FT8W",
              "FT0X",
              "FT2X",
              "FT4X",
              "FT5X",
              "FT8X",
              "FT0Z",
              "FT1Z",
              "FT2Z",
              "FT3Z",
              "FT4Z",
              "FT5Z",
              "FT6Z",
              "FT7Z",
              "FT8Z",
              "FW",
              "TW",
              "FY",
              "2E",
              "G",
              "M",
              "2D",
              "GD",
              "GT",
              "MD",
              "MT",
              "2I",
              "GI",
              "GN",
              "MI",
              "MN",
              "2J",
              "GH",
              "GJ",
              "MH",
              "MJ",
              "2A",
              "2M",
              "GM",
              "GS",
              "MA",
              "MM",
              "MS",
              "2U",
              "GP",
              "GU",
              "MP",
              "MU",
              "2W",
              "GC",
              "GW",
              "MC",
              "MW",
              "H4",
              "H40",
              "HA",
              "HG",
              "HB",
              "HE",
              "HB0",
              "HE0",
              "HC",
              "HD",
              "HC8",
              "HD8",
              "4V",
              "HH",
              "HI",
              "5J",
              "5K",
              "HJ",
              "HK",
              "5J0",
              "5K0",
              "HJ0",
              "HK0",
              "HJ0M",
              "HK0M",
              "6K",
              "6L",
              "6M",
              "6N",
              "D7",
              "D8",
              "D9",
              "DS",
              "DT",
              "HL",
              "KL9K",
              "3E",
              "3F",
              "H3",
              "H8",
              "H9",
              "HO",
              "HP",
              "HQ",
              "HR",
              "E2",
              "HS",
              "HV",
              "7Z",
              "8Z",
              "HZ",
              "I",
              "IG9",
              "IH9",
              "IM0",
              "IS",
              "IW0U",
              "IW0V",
              "IW0W",
              "IW0X",
              "IW0Y",
              "IW0Z",
              "IB9",
              "ID9",
              "IE9",
              "IF9",
              "II9",
              "IJ9",
              "IO9",
              "IQ9",
              "IR9",
              "IT9",
              "IU9",
              "IW9",
              "IY9",
              "J2",
              "J3",
              "J5",
              "J6",
              "J7",
              "J8",
              "7J",
              "7K",
              "7L",
              "7M",
              "7N",
              "8J",
              "8K",
              "8L",
              "8M",
              "8N",
              "JA",
              "JE",
              "JF",
              "JG",
              "JH",
              "JI",
              "JJ",
              "JK",
              "JL",
              "JM",
              "JN",
              "JO",
              "JP",
              "JQ",
              "JR",
              "JS",
              "JD1",
              "JT",
              "JU",
              "JV",
              "JW",
              "JX",
              "JY",
              "AA",
              "AB",
              "AC",
              "AD",
              "AE",
              "AF",
              "AG",
              "AI",
              "AJ",
              "AK",
              "K",
              "N",
              "W",
              "KG4",
              "AH0",
              "KH0",
              "NH0",
              "WH0",
              "AH1",
              "KH1",
              "NH1",
              "WH1",
              "AH2",
              "KH2",
              "NH2",
              "WH2",
              "AH3",
              "KH3",
              "NH3",
              "WH3",
              "AH4",
              "KH4",
              "NH4",
              "WH4",
              "AH5",
              "KH5",
              "NH5",
              "WH5",
              "AH6",
              "AH7",
              "KH6",
              "KH7",
              "NH6",
              "NH7",
              "WH6",
              "WH7",
              "AH7K",
              "KH7K",
              "NH7K",
              "WH7K",
              "AH8",
              "KH8",
              "NH8",
              "WH8",
              "AH9",
              "KH9",
              "NH9",
              "WH9",
              "AL",
              "KL",
              "NL",
              "WL",
              "KP1",
              "NP1",
              "WP1",
              "KP2",
              "NP2",
              "WP2",
              "KP3",
              "KP4",
              "NP3",
              "NP4",
              "WP3",
              "WP4",
              "KP5",
              "NP5",
              "WP5",
              "LA",
              "LB",
              "LC",
              "LD",
              "LE",
              "LF",
              "LG",
              "LH",
              "LI",
              "LJ",
              "LK",
              "LL",
              "LM",
              "LN",
              "AY",
              "AZ",
              "L1",
              "L2",
              "L3",
              "L4",
              "L5",
              "L6",
              "L7",
              "L8",
              "L9",
              "LO",
              "LP",
              "LQ",
              "LR",
              "LS",
              "LT",
              "LU",
              "LV",
              "LW",
              "LX",
              "LY",
              "LZ",
              "4T",
              "OA",
              "OB",
              "OC",
              "OD",
              "OE",
              "OF",
              "OG",
              "OH",
              "OI",
              "OJ",
              "OF0",
              "OG0",
              "OH0",
              "OI0",
              "OJ0",
              "OK",
              "OL",
              "OM",
              "ON",
              "OO",
              "OP",
              "OQ",
              "OR",
              "OS",
              "OT",
              "OX",
              "XP",
              "OW",
              "OY",
              "5P",
              "5Q",
              "OU",
              "OV",
              "OZ",
              "P2",
              "P4",
              "P5",
              "P6",
              "P7",
              "P8",
              "P9",
              "PA",
              "PB",
              "PC",
              "PD",
              "PE",
              "PF",
              "PG",
              "PH",
              "PI",
              "PJ2",
              "PJ4",
              "PJ5",
              "PJ6",
              "PJ0",
              "PJ7",
              "PJ8",
              "PP",
              "PQ",
              "PR",
              "PS",
              "PT",
              "PU",
              "PV",
              "PW",
              "PX",
              "PY",
              "ZV",
              "ZW",
              "ZX",
              "ZY",
              "ZZ",
              "PP0F",
              "PP0ZF",
              "PQ0F",
              "PQ0ZF",
              "PR0F",
              "PR0ZF",
              "PS0F",
              "PS0ZF",
              "PT0F",
              "PT0ZF",
              "PU0F",
              "PU0ZF",
              "PV0F",
              "PV0ZF",
              "PW0F",
              "PW0ZF",
              "PX0F",
              "PX0ZF",
              "PY0F",
              "PY0Z",
              "ZV0F",
              "ZV0ZF",
              "ZW0F",
              "ZW0ZF",
              "ZX0F",
              "ZX0ZF",
              "ZY0F",
              "ZY0Z",
              "ZZ0F",
              "ZZ0ZF",
              "PP0R",
              "PP0ZR",
              "PQ0R",
              "PQ0ZR",
              "PR0R",
              "PR0ZR",
              "PS0R",
              "PS0ZR",
              "PT0R",
              "PT0ZR",
              "PU0R",
              "PU0ZR",
              "PV0R",
              "PV0ZR",
              "PW0R",
              "PW0ZR",
              "PX0R",
              "PX0ZR",
              "PY0R",
              "ZV0R",
              "ZV0ZR",
              "ZW0R",
              "ZW0ZR",
              "ZX0R",
              "ZX0ZR",
              "ZY0R",
              "ZZ0R",
              "ZZ0ZR",
              "PP0S",
              "PP0ZS",
              "PQ0S",
              "PQ0ZS",
              "PR0S",
              "PR0ZS",
              "PS0S",
              "PS0ZS",
              "PT0S",
              "PT0ZS",
              "PU0S",
              "PU0ZS",
              "PV0S",
              "PV0ZS",
              "PW0S",
              "PW0ZS",
              "PX0S",
              "PX0ZS",
              "PY0S",
              "PY0ZS",
              "ZV0S",
              "ZV0ZS",
              "ZW0S",
              "ZW0ZS",
              "ZX0S",
              "ZX0ZS",
              "ZY0S",
              "ZY0ZS",
              "ZZ0S",
              "ZZ0ZS",
              "PP0T",
              "PP0ZT",
              "PQ0T",
              "PQ0ZT",
              "PR0T",
              "PR0ZT",
              "PS0T",
              "PS0ZT",
              "PT0T",
              "PT0ZT",
              "PU0T",
              "PU0ZT",
              "PV0T",
              "PV0ZT",
              "PW0T",
              "PW0ZT",
              "PX0T",
              "PX0ZT",
              "PY0T",
              "PY0ZT",
              "ZV0T",
              "ZV0ZT",
              "ZW0T",
              "ZW0ZT",
              "ZX0T",
              "ZX0ZT",
              "ZY0T",
              "ZY0ZT",
              "ZZ0T",
              "ZZ0ZT",
              "PZ",
              "RI1F",
              "S0",
              "S2",
              "S3",
              "S5",
              "S7",
              "S9",
              "7S",
              "8S",
              "SA",
              "SB",
              "SC",
              "SD",
              "SE",
              "SF",
              "SG",
              "SH",
              "SI",
              "SJ",
              "SK",
              "SL",
              "SM",
              "3Z",
              "HF",
              "SN",
              "SO",
              "SP",
              "SQ",
              "SR",
              "6T",
              "6U",
              "ST",
              "6A",
              "6B",
              "SS",
              "SU",
              "J4",
              "SV",
              "SW",
              "SX",
              "SY",
              "SZ",
              "J45",
              "SV5",
              "SW5",
              "SX5",
              "SY5",
              "SZ5",
              "J49",
              "SV9",
              "SW9",
              "SX9",
              "SY9",
              "SZ9",
              "T2",
              "T30",
              "T31",
              "T32",
              "T33",
              "6O",
              "T5",
              "T7",
              "T8",
              "TA",
              "TB",
              "TC",
              "YM",
              "TA1",
              "TB1",
              "TC1",
              "YM1",
              "TF",
              "TD",
              "TG",
              "TE",
              "TI",
              "TE9",
              "TI9",
              "TJ",
              "TK",
              "TL",
              "TN",
              "TR",
              "TT",
              "TU",
              "TY",
              "TZ",
              "R",
              "U",
              "R2F",
              "R2K",
              "RA2",
              "RC2F",
              "RC2K",
              "RD2F",
              "RD2K",
              "RE2F",
              "RE2K",
              "RF2F",
              "RF2K",
              "RG2F",
              "RG2K",
              "RJ2F",
              "RJ2K",
              "RK2F",
              "RK2K",
              "RL2F",
              "RL2K",
              "RM2F",
              "RM2K",
              "RN2F",
              "RN2K",
              "RO2F",
              "RO2K",
              "RQ2F",
              "RQ2K",
              "RT2F",
              "RT2K",
              "RU2F",
              "RU2K",
              "RV2F",
              "RV2K",
              "RW2F",
              "RW2K",
              "RX2F",
              "RX2K",
              "RY2F",
              "RY2K",
              "RZ2F",
              "RZ2K",
              "U2F",
              "U2K",
              "UA2",
              "UB2",
              "UC2",
              "UD2",
              "UE2",
              "UF2",
              "UG2",
              "UH2",
              "UI2",
              "R0",
              "R9",
              "RA0",
              "RA9",
              "RC0",
              "RC9",
              "RD0",
              "RD9",
              "RE0",
              "RE9",
              "RF0",
              "RF9",
              "RG0",
              "RG9",
              "RI0",
              "RI9",
              "RJ0",
              "RJ9",
              "RK0",
              "RK9",
              "RL0",
              "RL9",
              "RM0",
              "RM9",
              "RN0",
              "RN9",
              "RO0",
              "RO9",
              "RQ0",
              "RQ9",
              "RT0",
              "RT9",
              "RU0",
              "RU9",
              "RV0",
              "RV9",
              "RW0",
              "RW9",
              "RX0",
              "RX9",
              "RY0",
              "RY9",
              "RZ0",
              "RZ9",
              "U0",
              "U9",
              "UA0",
              "UA9",
              "UB0",
              "UB9",
              "UC0",
              "UC9",
              "UD0",
              "UD9",
              "UE0",
              "UE9",
              "UF0",
              "UF9",
              "UG0",
              "UG9",
              "UH0",
              "UH9",
              "UI0",
              "UI9",
              "UJ",
              "UK",
              "UL",
              "UM",
              "UN",
              "UO",
              "UP",
              "UQ",
              "EM",
              "EN",
              "EO",
              "U5",
              "UR",
              "US",
              "UT",
              "UU",
              "UV",
              "UW",
              "UX",
              "UY",
              "UZ",
              "V2",
              "V3",
              "V4",
              "V5",
              "V6",
              "V7",
              "V8",
              "CF",
              "CG",
              "CJ",
              "CK",
              "VA",
              "VB",
              "VC",
              "VE",
              "VG",
              "VX",
              "VY9",
              "XL",
              "XM",
              "CH1",
              "CI2",
              "CY1",
              "CZ2",
              "VD1",
              "VF2",
              "VO1",
              "VY2",
              "XJ1",
              "XK2",
              "XN1",
              "XO2",
              "AX",
              "VH",
              "VI",
              "VJ",
              "VK",
              "VL",
              "VM",
              "VN",
              "VZ",
              "AX9C",
              "AX9Y",
              "VH9C",
              "VH9Y",
              "VI9C",
              "VI9Y",
              "VJ9C",
              "VJ9Y",
              "VK9C",
              "VK9FC",
              "VK9KC",
              "VK9Y",
              "VK9ZY",
              "VL9C",
              "VL9Y",
              "VM9C",
              "VM9Y",
              "VN9C",
              "VN9Y",
              "VZ9C",
              "VZ9Y",
              "AX9L",
              "VH9L",
              "VI9L",
              "VJ9L",
              "VK9FL",
              "VK9L",
              "VK9ZL",
              "VL9L",
              "VM9L",
              "VN9L",
              "VZ9L",
              "AX9M",
              "VH9M",
              "VI9M",
              "VJ9M",
              "VK9M",
              "VL9M",
              "VM9M",
              "VN9M",
              "VZ9M",
              "AX9",
              "VH9",
              "VI9",
              "VJ9",
              "VK9",
              "VL9",
              "VM9",
              "VN9",
              "VZ9",
              "AX9W",
              "AX9Z",
              "VH9W",
              "VH9Z",
              "VI9W",
              "VI9Z",
              "VJ9W",
              "VJ9Z",
              "VK9FW",
              "VK9W",
              "VK9Z",
              "VL9W",
              "VL9Z",
              "VM9W",
              "VM9Z",
              "VN9W",
              "VN9Z",
              "VZ9W",
              "VZ9Z",
              "AX9X",
              "VH9X",
              "VI9X",
              "VJ9X",
              "VK9FX",
              "VK9KX",
              "VK9X",
              "VL9X",
              "VM9X",
              "VN9X",
              "VZ9X",
              "VP2E",
              "VP2M",
              "VP2V",
              "VP5",
              "VQ5",
              "VP6",
              "VP8",
              "CE9",
              "XR9",
              "VP9",
              "VQ9",
              "VR",
              "8T",
              "8U",
              "8V",
              "8W",
              "8X",
              "8Y",
              "AT",
              "AU",
              "AV",
              "AW",
              "VT",
              "VU",
              "VV",
              "VW",
              "VU4",
              "VU7",
              "4A",
              "4B",
              "4C",
              "6D",
              "6E",
              "6F",
              "6G",
              "6H",
              "6I",
              "6J",
              "XA",
              "XB",
              "XC",
              "XD",
              "XE",
              "XF",
              "XG",
              "XH",
              "XI",
              "4A4",
              "4B4",
              "4C4",
              "6D4",
              "6E4",
              "6F4",
              "6G4",
              "6H4",
              "6I4",
              "6J4",
              "XA4",
              "XB4",
              "XC4",
              "XD4",
              "XE4",
              "XF4",
              "XG4",
              "XH4",
              "XI4",
              "XT",
              "XU",
              "XW",
              "XX9",
              "XY",
              "XZ",
              "T6",
              "YA",
              "7A",
              "7B",
              "7C",
              "7D",
              "7E",
              "7F",
              "7G",
              "7H",
              "7I",
              "8A",
              "8B",
              "8C",
              "8D",
              "8E",
              "8F",
              "8G",
              "8H",
              "8I",
              "PK",
              "PL",
              "PM",
              "PN",
              "PO",
              "YB",
              "YC",
              "YD",
              "YE",
              "YF",
              "YG",
              "YH",
              "HN",
              "YI",
              "YJ",
              "6C",
              "YK",
              "YL",
              "H6",
              "H7",
              "HT",
              "YN",
              "YO",
              "YP",
              "YQ",
              "YR",
              "HU",
              "YS",
              "YT",
              "YU",
              "4M",
              "YV",
              "YW",
              "YX",
              "YY",
              "4M0",
              "YV0",
              "YW0",
              "YX0",
              "YY0",
              "Z2",
              "Z3",
              "Z6",
              "Z8",
              "ZA",
              "ZB",
              "ZG",
              "ZC4",
              "ZD7",
              "ZD8",
              "ZD9",
              "ZF",
              "ZK3",
              "ZK",
              "ZL",
              "ZL50",
              "ZM",
              "ZL7",
              "ZM7",
              "ZL8",
              "ZM8",
              "ZL9",
              "ZP",
              "H5",
              "S4",
              "S8",
              "V9",
              "ZR",
              "ZS",
              "ZT",
              "ZU",
              "ZR8",
              "ZS8",
              "ZT8",
              "ZU8"
            ])

  def find(callsign) do
    callsign =
      callsign
      |> String.trim()
      |> String.upcase()
      |> strip_strokes()

    case find_prefix_start(callsign) do
      {:ok, prefix} ->
        # Grab the remaining string AFTER the prefix
        rest = String.slice(callsign, String.length(prefix)..-1)

        # Look for any remaining characters and digits
        case Regex.run(~r/^\w*\d+/i, rest) do
          [rest_of_prefix] ->
            prefix <> rest_of_prefix

          nil ->
            prefix
        end

      :error ->
        nil
    end
  end

  # Converts crap like "K5/WW1X" to "K5"
  defp strip_strokes(callsign) do
    callsign
    |> String.split("/")
    |> Enum.sort_by(&String.length/1)
    |> Enum.reject(fn token ->
      token in ["A", "E", "J", "P", "MM", "AM", "QRP"]
    end)
    |> hd()
  end

  # Does a straight lookup on the @prefixes table, finding the longest match
  defp find_prefix_start(callsign) do
    for i <- 0..(String.length(callsign) - 1) do
      String.slice(callsign, 0..i)
    end
    |> Enum.reverse()
    |> Enum.find(&MapSet.member?(@prefixes, &1))
    |> case do
      nil -> :error
      prefix -> {:ok, prefix}
    end
  end
end
